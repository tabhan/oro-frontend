{% block _main_menu_shopping_lists_dropdown_container_widget %}
    {% set currentClass = 'checked' %}
    {% set attr = layout_attr_defaults(attr, {
        'data-page-component-module': 'oroshoppinglist/js/app/views/shoppinglist-widget-view',
        'data-page-component-options': {
            'currentClass': currentClass
        },
        'data-scroll': 'true',
        'data-role': 'tooltip-container',
        '~class': " shopping-list-widget__container"
    }) %}

    {% if is_one_shopping_list_enabled() %}
        {% set attr = layout_attr_defaults(attr, {
            '~class': " shopping-list-widget__container--limit"
        }) %}
    {% endif %}

    <div {{ block('block_attributes') }}>
        <fieldset>
            <legend class="sr-only">{{ 'oro.frontend.shoppinglist.fieldset_legend'|trans }}</legend>
            {% if shoppingLists|length > 0 -%}
                {% do block|merge_context({
                    shoppingList: shoppingLists[0],
                    shoppingListProducts: shoppingListProducts,
                    productsMatchedPrices: productsMatchedPrices,
                    shoppingListUnits: shoppingListUnits,
                }) %}
                {{ block('container_widget') }}
            {%- endif %}
        </fieldset>
    </div>
{% endblock %}

{% block shopping_list_dropdown_item_widget %}
    {% set attr = layout_attr_defaults(attr, {
        '~class': " shopping-list-dropdown__item shopping-list-dropdown__item--limit"
    }) %}
    <div {{ block('block_attributes') }}>
        {% if shoppingList.lineItems|length > 0 %}
            <div class="shopping-list-dropdown__product-list">
                {% for lineItem in shoppingList.lineItems|default([])|slice(0, 11) %}
                    {% if loop.index == 11 %}
                        <div class="shopping-list-dropdown__product-base">
                            <span class="shopping-list-dropdown__ellipsis">...</span>
                        </div>
                    {% else %}
                        {% set product = lineItem.product %}
                        {% set units = shoppingListUnits[product.id] %}
                        <div class="shopping-list-dropdown__product-item">
                            {%- for child in block -%}
                                {{ block_widget(child, {lineItem: lineItem, units: units, productsMatchedPrices: productsMatchedPrices}) }}
                            {%- endfor -%}
                        </div>
                    {% endif %}
                {% endfor %}
            </div>
        {% else %}
            <div class="shopping-list-dropdown__empty-list">
                {{- 'oro.frontend.shoppinglist.view.empty_single'|trans -}}
            </div>
        {% endif %}
        <div class="shopping-list-dropdown__footer">
            {% if shoppingList.lineItems|length > 0 %}
                <div class="shopping-list-dropdown__total">
                    {{ 'oro.frontend.shoppinglist.view.total.label'|trans }}
                    {{ 'oro.frontend.shoppinglist.view.items.label'|trans({'%count%': shoppingList.lineItems|length}) }}
                    <span aria-hidden="true">|</span> {{ shoppingList.subtotal.amount|oro_format_currency({'currency': shoppingList.subtotal.currency}) }}
                </div>
                <div class="shopping-list-dropdown__order-container">
                    {% set buttons = get_shopping_list_widget_buttons(shoppingList) %}
                    {% for button in buttons %}
                        {% include button.template with button.templateData|merge({onlyLink: true, aClass: 'btn btn--block btn--info', noIconText: true}) %}
                    {% endfor %}
                </div>
            {% endif %}
{#            <div class="shopping-list-dropdown__info-container">#}
{#                <a href="{{ oro_shopping_list_frontend_url() }}" class="shopping-list-dropdown__info">#}
{#                    <span class="fa-shopping-cart" aria-hidden="true"></span>#}
{#                    <span>{{ 'oro.frontend.shoppinglist.view.view_list.label'|trans }}</span>#}
{#                </a>#}
{#            </div>#}
        </div>
    </div>
{% endblock %}

{% block _main_menu_shopping_lists_dropdown_item_product_base_widget %}
    <div class="shopping-list-dropdown__product-base">
        {%- for child in block -%}
            {{ block_widget(child, {lineItem: lineItem, units: units, productsMatchedPrices: productsMatchedPrices}) }}
        {%- endfor -%}
    </div>
{% endblock %}

{% block _main_menu_shopping_lists_dropdown_item_product_base_total_widget %}
    {% set product = lineItem.product %}
    {% set productMatchedPrice = productsMatchedPrices[shoppingList.id][product.id][lineItem.productUnit.code] is defined ? productsMatchedPrices[shoppingList.id][product.id][lineItem.unit.code] : null %}
    <div class="shopping-list-dropdown__product-total">
        <div class="line-item-container" data-page-component-view = "practiceshoppinglist/js/app/views/editor/minicart-line-item-editor-view"
        data-page-component-options = "{{ {
            unit: lineItem.productUnit.code,
            units: units,
            quantity: lineItem.quantity,
            lineItemId: lineItem.id,
            orderId: lineItem.order ? lineItem.order.id : null
        }|json_encode }}">
        </div>
    </div>
{% endblock %}

{% block _main_menu_shopping_lists_dropdown_item_product_base_sku_widget %}
    {% set product = lineItem.product %}
    {% set productMatchedPrice = productsMatchedPrices[shoppingList.id][product.id][lineItem.productUnit.code] is defined ? productsMatchedPrices[shoppingList.id][product.id][lineItem.unit.code] : null %}

    <div class="shopping-list-dropdown__product-sku">
        {{- 'oro.frontend.shoppinglist.view.item.label'|trans }}
        <span class="shopping-list-dropdown__product-sku-value">{{ product.sku|e }}</span>
        {% if productMatchedPrice is not null %}
            <span data-name="price-value" style="float: right;">
                {{ productMatchedPrice.value|oro_format_currency({'currency': productMatchedPrice.currency}) }}
            </span>
        {% else %}
            <span data-name="price-not-found">{{ 'oro.pricing.frontend.product_prices.price_not_found.short_label'|trans }}</span>
        {% endif %}
    </div>
{% endblock %}

{% block shopping_list_dropdown_remove_widget %}
<div class="header-row__dropdown-footer">
    {%- for button in buttons -%}
        {% if button.name == 'oro_shoppinglist_frontend_delete_action' %}
            {%- set options = oro_action_frontend_options(button) -%}
            {%- set buttonOptions = options.options -%}
            <button
                    type="button"
                    class="shopping-list-widget__create-btn"
                    title="{{ button.label|trans }}"
                    aria-label="{{ button.ariaLabel|trans({'%name%': shoppingList.label}) }}"
                    data-operation-url="{{ buttonOptions.url }}"
                    data-options="{{ buttonOptions|json_encode }}"
                    data-page-component-module="oroaction/js/app/components/button-component"
            ><span class="icon fa-remove" aria-hidden="true"></span>
                {{- button.label|trans -}}
            </button>
        {% endif %}
    {%- endfor -%}
</div>
{% endblock %}

{% block shopping_list_dropdown_view_widget %}
    <div class="shopping-list-dropdown__info-container">
        <a href="{{ oro_shopping_list_frontend_url() }}" class="shopping-list-dropdown__info">
            <span class="fa-shopping-cart" aria-hidden="true"></span>
            <span>{{ 'oro.frontend.shoppinglist.view.view_list.label'|trans }}</span>
        </a>
    </div>
{% endblock %}
